
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>MATS module &#8212; MATS 1.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="MATS Example using Experimental and Synthetic Data" href="MATS Example using Experimental and Synthetic Data.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="MATS Example using Experimental and Synthetic Data.html" title="MATS Example using Experimental and Synthetic Data"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MATS 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-MATS">
<span id="mats-module"></span><h1>MATS module<a class="headerlink" href="#module-MATS" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="MATS.Dataset">
<em class="property">class </em><code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">Dataset</code><span class="sig-paren">(</span><em class="sig-param">spectra</em>, <em class="sig-param">dataset_name</em>, <em class="sig-param">baseline_order=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Combines spectrum objects into a Dataset object to enable multi-spectrum fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectra</strong> (<em>list</em>) – list of spectrum objects to be included in the Dataset. Example [spectrum_1, spectrum_2, …]</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Used to provide a name for the Dataset to use when saving files</p></li>
<li><p><strong>baseline_order</strong> (<em>int</em>) – sets the baseline order for all spectra in the dataset.  This will automatically be set to the maximum baseline order across all spectrum included in the Dataset.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MATS.Dataset.average_QF">
<code class="sig-name descname">average_QF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.average_QF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.average_QF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Average QF from all spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>average_QF</strong> – average QF of all spectra in dataset</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.correct_component_list">
<code class="sig-name descname">correct_component_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.correct_component_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.correct_component_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects so that all spectrum share the same molecules, but the mole fraction is fixed to zero where molecules are not present (called in the initialization of the class).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.correct_etalon_list">
<code class="sig-name descname">correct_etalon_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.correct_etalon_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.correct_etalon_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects so that all spectrum share the same number of etalons, but the amplitude and period are fixed to zero where appropriate(called in the initialization of the class).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.generate_baseline_paramlist">
<code class="sig-name descname">generate_baseline_paramlist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.generate_baseline_paramlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.generate_baseline_paramlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a csv file called dataset_name + _baseline_paramlist, which will be used to generate another csv file that is used for fitting spectrum dependent parameters with columns for
spectrum number, segment number, x_shift, concentration for each molecule in the dataset, baseline terms (a = 0th order term, b = 1st order, etc), and etalon terms (set an amplitude, period, and phase for the number of etalons listed for each spectrum in the Dataset).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>baseline_paramlist</strong> – dataframe containing information describing baseline parameters.  Also saves to .csv.  Either file can be edited before making the baseline parameter list used for fitting.  If editting the .csv file will need to regenerate dataframe from .csv.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.generate_summary_file">
<code class="sig-name descname">generate_summary_file</code><span class="sig-paren">(</span><em class="sig-param">save_file=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.generate_summary_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.generate_summary_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a summary file combining spectral information from all spectra in the Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>save_file</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then a .csv is generated in addition to the dataframe. The default is False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary_file</strong> – Summary dataframe comprised of spectral information inculding model and residuals for all spectra in Dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_baseline_order">
<code class="sig-name descname">get_baseline_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_baseline_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_baseline_order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_dataset_name">
<code class="sig-name descname">get_dataset_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_dataset_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_dataset_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_etalons">
<code class="sig-name descname">get_etalons</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_etalons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_etalons" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of number of etalons for spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dataset_etalon_list</strong> – etalon keys across spectra</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_list_spectrum_numbers">
<code class="sig-name descname">get_list_spectrum_numbers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_list_spectrum_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_list_spectrum_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a list of all spectrum_numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>spec_num_list</strong> – list of all spectrum numbers used in the dataset.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_molecules">
<code class="sig-name descname">get_molecules</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_molecules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of molecules in spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dataset_molecule_list</strong> – list of molecules in spectra</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_number_nominal_temperatures">
<code class="sig-name descname">get_number_nominal_temperatures</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_number_nominal_temperatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_number_nominal_temperatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of nominal temperatures in the .</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>num_nominal_temperatures</strong> (<em>int</em>) – number of nominal temperatures in the Dataset</p></li>
<li><p><strong>nominal_temperatures</strong> (<em>list</em>) – list of all nominal temperatures listed in the input spectra</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_number_spectra">
<code class="sig-name descname">get_number_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_number_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_number_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectra">
<code class="sig-name descname">get_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectra_extremes">
<code class="sig-name descname">get_spectra_extremes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectra_extremes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectra_extremes" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the minimum and maximum wavenumber for the entire Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>wave_min</strong> (<em>float</em>) – The minimum wavenumber in all spectra in the Dataset.</p></li>
<li><p><strong>wave_max</strong> (<em>float</em>) – The maximum wavenumber in all spectra in the Dataset.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectrum_extremes">
<code class="sig-name descname">get_spectrum_extremes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectrum_extremes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectrum_extremes" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the minimum and maximum wavenumber for each spectrum in the Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>extreme_dictionary</strong> – Dictionary where the key corresponds to the spectrum_num with the value equal to a list where list[0] = minimum wavenumber in spectrum and list[1] = maximum wavenumber in spectrum</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectrum_filename">
<code class="sig-name descname">get_spectrum_filename</code><span class="sig-paren">(</span><em class="sig-param">spectrum_num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectrum_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectrum_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets spectrum filename for spectrum in Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spectrum_num</strong> (<em>int</em>) – Integer assigned to a given spectrum.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filename</strong> – if spectrum_num in Dataset then the filename for that the spectrum_number is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectrum_pressure">
<code class="sig-name descname">get_spectrum_pressure</code><span class="sig-paren">(</span><em class="sig-param">spectrum_num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectrum_pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectrum_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets spectrum pressure for spectrum in Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spectrum_num</strong> (<em>int</em>) – Integer assigned to a given spectrum.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pressure</strong> – if spectrum_num in Dataset then the pressure (torr) for that the spectrum_number is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.get_spectrum_temperature">
<code class="sig-name descname">get_spectrum_temperature</code><span class="sig-paren">(</span><em class="sig-param">spectrum_num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.get_spectrum_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.get_spectrum_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets spectrum temperature for spectrum in Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spectrum_num</strong> (<em>int</em>) – Integer assigned to a given spectrum.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>temperature</strong> – if spectrum_num in Dataset then the temperature (K) for that the spectrum_number is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.max_baseline_order">
<code class="sig-name descname">max_baseline_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.max_baseline_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.max_baseline_order" title="Permalink to this definition">¶</a></dt>
<dd><p>sets the baseline order to be equal to the maximum in any of the included spectra.</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.plot_model_residuals">
<code class="sig-name descname">plot_model_residuals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.plot_model_residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.plot_model_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot showing both the model and experimental data as a function of wavenumber in the main plot with a subplot showing the residuals as function of wavenumber.</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.renumber_spectra">
<code class="sig-name descname">renumber_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.renumber_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.renumber_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>renumbers the spectra to be sequential starting at 1 (called in the initialization of the class).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Dataset.set_baseline_order">
<code class="sig-name descname">set_baseline_order</code><span class="sig-paren">(</span><em class="sig-param">new_baseline_order</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.set_baseline_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.set_baseline_order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.set_dataset_name">
<code class="sig-name descname">set_dataset_name</code><span class="sig-paren">(</span><em class="sig-param">new_dataset_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.set_dataset_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.set_dataset_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Dataset.set_spectra">
<code class="sig-name descname">set_spectra</code><span class="sig-paren">(</span><em class="sig-param">new_spectra</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Dataset.set_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Dataset.set_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="MATS.Edit_Fit_Param_Files">
<em class="property">class </em><code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">Edit_Fit_Param_Files</code><span class="sig-paren">(</span><em class="sig-param">base_linelist_file</em>, <em class="sig-param">param_linelist_file</em>, <em class="sig-param">new_base_linelist_file=None</em>, <em class="sig-param">new_param_linelist_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Edit_Fit_Param_Files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Edit_Fit_Param_Files" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Allows for the baseline and parameter files to be editted in jupyter notebook.  Can also edit everything in .csv</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_linelist_file</strong> (<em>str</em>) – name of the .csv file containing the baseline parameters generated in format specified in the generate fit parameters class.</p></li>
<li><p><strong>param_linelist_file</strong> (<em>str</em>) – name of the .csv file containing the linelist parameters generated in format specified in the generate fit parameters class.</p></li>
<li><p><strong>new_base_linelist_file</strong> (<em>str</em>) – name of the to save the baseline param list as after editing. IF the value is None (default) then it will edit the input.</p></li>
<li><p><strong>new_param_linelist_file</strong> (<em>str</em>) – name of the to save the linelist param list as after editing. IF the value is None (default) then it will edit the input.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MATS.Edit_Fit_Param_Files.edit_generated_baselist">
<code class="sig-name descname">edit_generated_baselist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Edit_Fit_Param_Files.edit_generated_baselist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Edit_Fit_Param_Files.edit_generated_baselist" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows editting of baseline linelist in notebook</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Edit_Fit_Param_Files.edit_generated_paramlist">
<code class="sig-name descname">edit_generated_paramlist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Edit_Fit_Param_Files.edit_generated_paramlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Edit_Fit_Param_Files.edit_generated_paramlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows editting of parameter linelist in notebook</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Edit_Fit_Param_Files.save_editted_baselist">
<code class="sig-name descname">save_editted_baselist</code><span class="sig-paren">(</span><em class="sig-param">baseline_widget</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Edit_Fit_Param_Files.save_editted_baselist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Edit_Fit_Param_Files.save_editted_baselist" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves edits of baseline linelist in notebook</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Edit_Fit_Param_Files.save_editted_paramlist">
<code class="sig-name descname">save_editted_paramlist</code><span class="sig-paren">(</span><em class="sig-param">param_widget</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Edit_Fit_Param_Files.save_editted_paramlist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Edit_Fit_Param_Files.save_editted_paramlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves edits of parameter linelist in notebook</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MATS.Fit_DataSet">
<em class="property">class </em><code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">Fit_DataSet</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">base_linelist_file</em>, <em class="sig-param">param_linelist_file</em>, <em class="sig-param">minimum_parameter_fit_intensity=1e-27</em>, <em class="sig-param">baseline_limit=False</em>, <em class="sig-param">baseline_limit_factor=10</em>, <em class="sig-param">pressure_limit=False</em>, <em class="sig-param">pressure_limit_factor=10</em>, <em class="sig-param">temperature_limit=False</em>, <em class="sig-param">temperature_limit_factor=10</em>, <em class="sig-param">molefraction_limit=False</em>, <em class="sig-param">molefraction_limit_factor=10</em>, <em class="sig-param">etalon_limit=False</em>, <em class="sig-param">etalon_limit_factor=50</em>, <em class="sig-param">x_shift_limit=False</em>, <em class="sig-param">x_shift_limit_magnitude=0.1</em>, <em class="sig-param">nu_limit=False</em>, <em class="sig-param">nu_limit_magnitude=0.1</em>, <em class="sig-param">sw_limit=False</em>, <em class="sig-param">sw_limit_factor=10</em>, <em class="sig-param">gamma0_limit=False</em>, <em class="sig-param">gamma0_limit_factor=10</em>, <em class="sig-param">n_gamma0_limit=True</em>, <em class="sig-param">n_gamma0_limit_factor=10</em>, <em class="sig-param">delta0_limit=False</em>, <em class="sig-param">delta0_limit_factor=10</em>, <em class="sig-param">n_delta0_limit=True</em>, <em class="sig-param">n_delta0_limit_factor=10</em>, <em class="sig-param">SD_gamma_limit=False</em>, <em class="sig-param">SD_gamma_limit_factor=10</em>, <em class="sig-param">n_gamma2_limit=True</em>, <em class="sig-param">n_gamma2_limit_factor=10</em>, <em class="sig-param">SD_delta_limit=True</em>, <em class="sig-param">SD_delta_limit_factor=10</em>, <em class="sig-param">n_delta2_limit=True</em>, <em class="sig-param">n_delta2_limit_factor=10</em>, <em class="sig-param">nuVC_limit=False</em>, <em class="sig-param">nuVC_limit_factor=10</em>, <em class="sig-param">n_nuVC_limit=True</em>, <em class="sig-param">n_nuVC_limit_factor=10</em>, <em class="sig-param">eta_limit=True</em>, <em class="sig-param">eta_limit_factor=10</em>, <em class="sig-param">linemixing_limit=False</em>, <em class="sig-param">linemixing_limit_factor=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides the fitting functionality for a Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>object</em>) – Dataset Object.</p></li>
<li><p><strong>base_linelist_file</strong> (<em>str</em>) – filename for file containing baseline parameters.</p></li>
<li><p><strong>param_linelist_file</strong> (<em>TYPE</em>) – filename for file containing parmeter parameters..</p></li>
<li><p><strong>minimum_parameter_fit_intensity</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum intensity for parameters to be generated for fitting. NOTE: Even if a value is floated in the param_linelist if it is below this threshold then it won’t be a floated.. The default is 1e-27.</p></li>
<li><p><strong>baseline_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on baseline parameter solutions. The default is False.</p></li>
<li><p><strong>baseline_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor that the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>pressure_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on pressure solutions. The default is False.</p></li>
<li><p><strong>pressure_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>temperature_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on temperature solutions. The default is False.</p></li>
<li><p><strong>temperature_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>molefraction_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on mole fraction solutions. The default is False.</p></li>
<li><p><strong>molefraction_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is 10.</p></li>
<li><p><strong>etalon_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on etalon solutions. The default is False.</p></li>
<li><p><strong>etalon_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 50. #phase is constrained to +/- 2pi</p></li>
<li><p><strong>x_shift_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on x-shift solutions. The default is False.</p></li>
<li><p><strong>x_shift_limit_magnitude</strong> (<em>float</em><em>, </em><em>optional</em>) – The magnitude variables set the +/- range of the variable in cm-1. The default is 0.1.</p></li>
<li><p><strong>nu_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on line center solutions. The default is False.</p></li>
<li><p><strong>nu_limit_magnitude</strong> (<em>float</em><em>, </em><em>optional</em>) – The magnitude variables set the +/- range of the variable in cm-1. The default is 0.1.</p></li>
<li><p><strong>sw_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on line intensity solutions. The default is False.</p></li>
<li><p><strong>sw_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>gamma0_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on collisional half-width solutions. The default is False.</p></li>
<li><p><strong>gamma0_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>n_gamma0_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – DESCIf True, then impose min/max limits on temperature exponent for half width solutions. The default is True.</p></li>
<li><p><strong>n_gamma0_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>delta0_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on collisional shift solutions. The default is False.</p></li>
<li><p><strong>delta0_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>n_delta0_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on temperature exponent of the collisional shift solutions. The default is True.</p></li>
<li><p><strong>n_delta0_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is 10.</p></li>
<li><p><strong>SD_gamma_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on the aw solutions. The default is False.</p></li>
<li><p><strong>SD_gamma_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>n_gamma2_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on temperature exponent of the speed-dependent width solutions. The default is True.</p></li>
<li><p><strong>n_gamma2_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>SD_delta_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on as solutions. The default is True.</p></li>
<li><p><strong>SD_delta_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>n_delta2_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on temperature exponent of the speed-dependent shift solutions. The default is True.</p></li>
<li><p><strong>n_delta2_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>nuVC_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on dicke narrowing solutions. The default is False.</p></li>
<li><p><strong>nuVC_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>n_nuVC_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on temperature exponent of dicke narrowing solutions. The default is True.</p></li>
<li><p><strong>n_nuVC_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is 10.</p></li>
<li><p><strong>eta_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on correlation parameter solutions.. The default is True.</p></li>
<li><p><strong>eta_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.The default is 10.</p></li>
<li><p><strong>linemixing_limit</strong> (<em>bool</em><em>, </em><em>optional</em>) – The factor variable describes the multiplicative factor the value can vary by min = 1/factor * init_guess, max = factor* init_guess. NOTE: If the init_guess for a parameter is equal to zero, then the limits aren’t imposed because 1) then it would constrain the fit to 0 and 2) LMfit won’t let you set min = max.. The default is False.</p></li>
<li><p><strong>linemixing_limit_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – If True, then impose min/max limits on line-mixing solutions.. The default is 10.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MATS.Fit_DataSet.constrained_baseline">
<code class="sig-name descname">constrained_baseline</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">baseline_segment_constrained=True</em>, <em class="sig-param">xshift_segment_constrained=True</em>, <em class="sig-param">molefraction_segment_constrained=True</em>, <em class="sig-param">etalon_amp_segment_constrained=True</em>, <em class="sig-param">etalon_freq_segment_constrained=True</em>, <em class="sig-param">etalon_phase_segment_constrained=True</em>, <em class="sig-param">pressure_segment_constrained=True</em>, <em class="sig-param">temperature_segment_constrained=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.constrained_baseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.constrained_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Imposes baseline constraints when using multiple segments per spectrum, ie all baseline parameters can be the same across the entire spectrum except for the etalon phase, which is allowed to vary per segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>lmfit parameter object</em>) – the params object is a dictionary comprised of all parameters translated from dataframes into a dictionary format compatible with lmfit.</p></li>
<li><p><strong>baseline_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the baseline terms are constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>xshift_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the x_shift terms are constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>molefraction_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the mole fraction for that molecule is constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>etalon_amp_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the etalon amplitude is constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>etalon_freq_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the etalon frequency is constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>etalon_phase_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the etalon phase is constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>pressure_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the pressure is constrained across each spectrum.. The default is True.</p></li>
<li><p><strong>temperature_segment_constrained</strong> (<em>bool</em><em>, </em><em>optional</em>) – True means the temperature is constrained across each spectrum.. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>params</strong> – the params object is a dictionary comprised of all parameters translated from dataframes into a dictionary format compatible with lmfit.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lmfit parameter object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Fit_DataSet.fit_data">
<code class="sig-name descname">fit_data</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">wing_cutoff=50</em>, <em class="sig-param">wing_wavenumbers=50</em>, <em class="sig-param">wing_method='wing_cutoff'</em>, <em class="sig-param">xtol=1e-07</em>, <em class="sig-param">maxfev=2000</em>, <em class="sig-param">ftol=1e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.fit_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.fit_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the lmfit minimizer to do the fitting through the simulation model function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>lmfit parameter object</em>) – the params object is a dictionary comprised of all parameters translated from dataframes into a dictionary format compatible with lmfit.</p></li>
<li><p><strong>wing_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – number of voigt half-widths to simulate on either side of each line. The default is 50.</p></li>
<li><p><strong>wing_wavenumbers</strong> (<em>float</em><em>, </em><em>optional</em>) – number of wavenumbers to simulate on either side of each line. The default is 50.</p></li>
<li><p><strong>wing_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Provides choice between the wing_cutoff and wing_wavenumbers line cut-off options. The default is ‘wing_cutoff’.</p></li>
<li><p><strong>xtol</strong> (<em>float</em><em>, </em><em>optional</em>) – Absolute error in xopt between iterations that is acceptable for convergence. The default is 1e-7.</p></li>
<li><p><strong>maxfev</strong> (<em>float</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is 2000.</p></li>
<li><p><strong>ftol</strong> (<em>The maximum number of calls to the function.</em><em>, </em><em>optional</em>) – Absolute error in func(xopt) between iterations that is acceptable for convergence.. The default is 1e-7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – contains all fit results as LMFit results object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LMFit result Object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Fit_DataSet.generate_params">
<code class="sig-name descname">generate_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.generate_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.generate_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the lmfit parameter object that will be used in fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>params</strong> – the parameter object is a dictionary comprised of all parameters translated from dataframes into a dictionary format compatible with lmfit</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>lmfit parameter object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Fit_DataSet.residual_analysis">
<code class="sig-name descname">residual_analysis</code><span class="sig-paren">(</span><em class="sig-param">result</em>, <em class="sig-param">indv_resid_plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.residual_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.residual_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the model and residual arrays in each spectrum object with the results of the fit and gives the option of generating the combined absorption and residual plot for each spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>LMFit result Object</em>) – contains all fit results as LMFit results object.</p></li>
<li><p><strong>indv_resid_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if you want to show residual plots for each spectra.. The default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Fit_DataSet.simulation_model">
<code class="sig-name descname">simulation_model</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">wing_cutoff=50</em>, <em class="sig-param">wing_wavenumbers=50</em>, <em class="sig-param">wing_method='wing_cutoff'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.simulation_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.simulation_model" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the model used for fitting that includes baseline and resonant absorption models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>lmfit parameter object</em>) – the params object is a dictionary comprised of all parameters translated from dataframes into a dictionary format compatible with lmfit.</p></li>
<li><p><strong>wing_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – number of voigt half-widths to simulate on either side of each line. The default is 50.</p></li>
<li><p><strong>wing_wavenumbers</strong> (<em>float</em><em>, </em><em>optional</em>) – number of wavenumbers to simulate on either side of each line. The default is 50.</p></li>
<li><p><strong>wing_method</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Provides choice between the wing_cutoff and wing_wavenumbers line cut-off options. The default is ‘wing_cutoff’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>total_residuals</strong> – residuals for all spectra in Dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Fit_DataSet.update_params">
<code class="sig-name descname">update_params</code><span class="sig-paren">(</span><em class="sig-param">result</em>, <em class="sig-param">base_linelist_update_file=None</em>, <em class="sig-param">param_linelist_update_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Fit_DataSet.update_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Fit_DataSet.update_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the baseline and line parameter files based on fit results with the option to write over the file (default) or save as a new file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>LMFit result Object</em>) – contains all fit results as LMFit results object.</p></li>
<li><p><strong>base_linelist_update_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of file to save the updated baseline parameters. Default is to override the input. The default is None.</p></li>
<li><p><strong>param_linelist_update_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of file to save the updated line parameters. Default is to override the input. The default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MATS.Generate_FitParam_File">
<em class="property">class </em><code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">Generate_FitParam_File</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">param_linelist</em>, <em class="sig-param">base_linelist</em>, <em class="sig-param">lineprofile='VP'</em>, <em class="sig-param">linemixing=False</em>, <em class="sig-param">threshold_intensity=1e-30</em>, <em class="sig-param">fit_intensity=1e-26</em>, <em class="sig-param">fit_window=1.5</em>, <em class="sig-param">sim_window=5</em>, <em class="sig-param">param_linelist_savename='Parameter_LineList'</em>, <em class="sig-param">base_linelist_savename='Baseline_LineList'</em>, <em class="sig-param">nu_constrain=True</em>, <em class="sig-param">sw_constrain=True</em>, <em class="sig-param">gamma0_constrain=True</em>, <em class="sig-param">delta0_constrain=True</em>, <em class="sig-param">aw_constrain=True</em>, <em class="sig-param">as_constrain=True</em>, <em class="sig-param">nuVC_constrain=True</em>, <em class="sig-param">eta_constrain=True</em>, <em class="sig-param">linemixing_constrain=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class generates the parameter files used in fitting and sets up fit settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>object</em>) – Dataset object to be used in the fits</p></li>
<li><p><strong>param_linelist</strong> (<em>dataframe</em>) – parameter linelist dataframe name, where the dataframe has the appropriate column headers</p></li>
<li><p><strong>base_linelist</strong> (<em>dataframe</em>) – baseline parameter dataframe name generated from the dataset.generate_baseline_paramlist() function.</p></li>
<li><p><strong>lineprofile</strong> (<em>str</em>) – lineprofile to use for the simulation. This sets values in the parameter linelist to 0 and forces them to not vary unless manually changed. Default values is VP, voigt profile. Options are VP, SDVP, NGP, SDNGP, HTP.</p></li>
<li><p><strong>linemixing</strong> (<em>bool</em>) – If False, then all linemixing parameters are set to 0 and not able to float.  Default is False.</p></li>
<li><p><strong>threshold_intensity</strong> (<em>float</em>) – This is the minimum line intensity that will be simulated. Default value is 1e-30.</p></li>
<li><p><strong>fit_intensity</strong> (<em>float</em>) – This is the minimum line intensity for which parameters will be set to float. This can be overwritten manually. Default value is 1e-26.</p></li>
<li><p><strong>fit_window</strong> (<em>float</em>) – currently not used</p></li>
<li><p><strong>sim_window</strong> (<em>float</em>) – This is the region outside of the wavelength region of the dataset that will be simulated for analysis. Default value is 5 cm-1.</p></li>
<li><p><strong>base_linelist_savename</strong> (<em>str</em>) – filename that the baseline linelist will be saved as. Default is Baseline_LineList</p></li>
<li><p><strong>param_linelist_savename</strong> (<em>str</em>) – filename that the parameter linelist will be saved as. Default is Parameter_LineList.</p></li>
<li><p><strong>nu_constrain</strong> (<em>bool</em>) – True indicates that the line centers will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>sw_constrain</strong> (<em>bool</em>) – True indicates that the line intensities will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>gamma0_constrain</strong> (<em>bool</em>) – True indicates that the collisional width will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>delta0_constrain</strong> (<em>bool</em>) – True indicates that the shift will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>aw_constrain</strong> (<em>bool</em>) – True indicates that the speed dependent width will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>as_constrain</strong> (<em>bool</em>) – True indicates that the speed dependent shift will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>nuVC_constrain</strong> (<em>bool</em>) – True indicates that the dicke narrowing term will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>eta_constrain</strong> (<em>bool</em>) – True indicates that the correlation parameter will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</p></li>
<li><p><strong>linemixing_constrain</strong> (<em>bool</em>) – True indicates that the first-order linemixing term will be a global variable across all spectra. False generates a new value for each spectrum in the datas</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MATS.Generate_FitParam_File.generate_fit_baseline_linelist">
<code class="sig-name descname">generate_fit_baseline_linelist</code><span class="sig-paren">(</span><em class="sig-param">vary_baseline=True</em>, <em class="sig-param">vary_pressure=False</em>, <em class="sig-param">vary_temperature=False</em>, <em class="sig-param">vary_molefraction={}</em>, <em class="sig-param">vary_xshift=False</em>, <em class="sig-param">vary_etalon_amp=False</em>, <em class="sig-param">vary_etalon_freq=False</em>, <em class="sig-param">vary_etalon_phase=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File.generate_fit_baseline_linelist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File.generate_fit_baseline_linelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the baseline line list used in fitting and updates the fitting booleans to desired settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vary_baseline</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then sets all baseline parameters for all spectra to float. The default is True.</p></li>
<li><p><strong>vary_pressure</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then the pressures for all spectra are floated.  This should be used with caution as the impact these parameters have on other floated parameters might lead to an unstable solution. The default is False.</p></li>
<li><p><strong>vary_temperature</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then the temperatures for all spectra are floated. This should be used with caution as the impact these parameters have on other floated parameters might lead to an unstable solution.The default is False.</p></li>
<li><p><strong>vary_molefraction</strong> (<em>dict</em><em>, </em><em>optional</em>) – keys to dictionary correspond to molecule id where the value is boolean flag, which dictates whether to float the mole fraction. The default is {}. Example: {7: True, 1: False}</p></li>
<li><p><strong>vary_xshift</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then sets x-shift parameters for all spectra to float. The default is False.</p></li>
<li><p><strong>vary_etalon_amp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then sets etalon amplitude parameters for all spectra to float. The default is False.</p></li>
<li><p><strong>vary_etalon_freq</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then sets etalon period parameters for all spectra to float. . The default is False.</p></li>
<li><p><strong>vary_etalon_phase</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then sets etalon phase parameters for all spectra to float.. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>base_linelist_df</strong> – returns dataframe based on baseline line list with addition of a vary and err column for every floatable parameter.  The vary columns are defined by the inputs.  The err columns will be populated from fit results.  The dataframe is also saved as a .csv file..</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Generate_FitParam_File.generate_fit_param_linelist_from_linelist">
<code class="sig-name descname">generate_fit_param_linelist_from_linelist</code><span class="sig-paren">(</span><em class="sig-param">vary_nu={}</em>, <em class="sig-param">vary_sw={}</em>, <em class="sig-param">vary_gamma0={}</em>, <em class="sig-param">vary_n_gamma0={}</em>, <em class="sig-param">vary_delta0={}</em>, <em class="sig-param">vary_n_delta0={}</em>, <em class="sig-param">vary_aw={}</em>, <em class="sig-param">vary_n_gamma2={}</em>, <em class="sig-param">vary_as={}</em>, <em class="sig-param">vary_n_delta2={}</em>, <em class="sig-param">vary_nuVC={}</em>, <em class="sig-param">vary_n_nuVC={}</em>, <em class="sig-param">vary_eta={}</em>, <em class="sig-param">vary_linemixing={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File.generate_fit_param_linelist_from_linelist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File.generate_fit_param_linelist_from_linelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the parameter line list used in fitting and updates the fitting booleans to desired settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vary_nu</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope line centers should be floated.  Each key in the dictionary corresponds to a molecule, where the values are a dictionary corresponding to local_iso_ids as keys and boolean values acting as boolean flags. True means float the nu for that molecule and isotope. Example vary_nu = {7:{1:True, 2: False, 3: False}, 1:{1:False, 2: False, 3: False}}, would indicate that line centers of all main oxygen isotopes would be floated (if the line intensity is greater than the fit intensity), where the line centers for all other O2 isotopes and all water isotopes would not be varied. If these value are left blank, then all variable would have to be manually switched to float. The default is {}.</p></li>
<li><p><strong>vary_sw</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope line intensities should be floated.  Follows nu_vary example.  The default is {}.</p></li>
<li><p><strong>vary_gamma0</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope collisional half-width should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_n_gamma0</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the half width  should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_delta0</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope pressure shift should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_n_delta0</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the pressure shift should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_aw</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope ratio of the speed dependent width to the half-width should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_n_gamma2</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the speed dependent width should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_as</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope the ratio of the speed dependent shift to the shift should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_n_delta2</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the speed dependent shift should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_nuVC</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope dicke narrowing should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_n_nuVC</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope  coefficient of the temperature dependence of the dicke narrowing should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_eta</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope correlation parameter for the VC and SD effects should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
<li><p><strong>vary_linemixing</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dictionary of dictionaries setting whether the molecule and isotope first-order line-mixing should be floated.  Follows nu_vary example.  . The default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>param_linelist_df</strong> – returns dataframe based on parameter line list with addition of a vary and err column for every floatable parameter.  The vary columns are defined by the inputs and the fit_intensity value.  The err columns will be populated from fit results.  The dataframe is also saved as a .csv file.  line intensity will be normalized by the fit_intensity (set to the sw_scale_factor). The term ‘sw’ is now equal to the normalized value, such that in the simulation ‘sw’<a href="#id1"><span class="problematic" id="id2">*</span></a>sw_scale_factor is used for the line intensity. Because line intensities are so small it is difficult to fit the value without normalization.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Generate_FitParam_File.get_base_linelist">
<code class="sig-name descname">get_base_linelist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File.get_base_linelist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File.get_base_linelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Generate_FitParam_File.get_dataset">
<code class="sig-name descname">get_dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File.get_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File.get_dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Generate_FitParam_File.get_param_linelist">
<code class="sig-name descname">get_param_linelist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Generate_FitParam_File.get_param_linelist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Generate_FitParam_File.get_param_linelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="MATS.HTP_from_DF_select">
<code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">HTP_from_DF_select</code><span class="sig-paren">(</span><em class="sig-param">linelist</em>, <em class="sig-param">waves</em>, <em class="sig-param">wing_cutoff=50</em>, <em class="sig-param">wing_wavenumbers=50</em>, <em class="sig-param">wing_method='wing_cutoff'</em>, <em class="sig-param">p=1</em>, <em class="sig-param">T=296</em>, <em class="sig-param">molefraction={}</em>, <em class="sig-param">natural_abundance=True</em>, <em class="sig-param">abundance_ratio_MI={}</em>, <em class="sig-param">Diluent={}</em>, <em class="sig-param">diluent='air'</em>, <em class="sig-param">IntensityThreshold=1e-30</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#HTP_from_DF_select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.HTP_from_DF_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the absorbance (ppm/cm) based on input line list, wavenumbers, and spectrum environmental parameters.</p>
<p>Outline</p>
<ol class="arabic simple">
<li><p>Uses provided wavenumber axis</p></li>
<li><p>Calculates the molecular density from pressure and temperature</p></li>
<li><p>Sets up Diluent dictionary if not given as input</p></li>
<li><p>Calculates line intensity and doppler width at temperature for all lines</p></li>
<li><p>Loops through each line in the line list and loops through each diluent, generating a line parameter at experimental conditions
that is the appropriate ratio of each diluent species corrected for pressure and temperature.  For each line, simulate the line for the given simulation cutoffs and add to cross section</p></li>
<li><p>Return wavenumber and cross section arrays</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linelist</strong> (<em>dataframe</em>) – <dl>
<dt>Pandas dataframe with the following column headers, where species corresponds to each diluent in the spectrum objects included in the dataset and nominal temperature corresponds to the nominal temperatures included in the dataset:</dt><dd><p>nu = wavenumber of the spectral line transition (cm-1) in vacuum</p>
<p>sw = The spectral line intensity (cm−1/(molecule⋅cm−2)) at Tref=296K</p>
<p>elower = The lower-state energy of the transition (cm-1)</p>
<p>molec_id = HITRAN molecular ID number</p>
<p>local_iso_id = HITRAN isotopologue ID number</p>
<p>gamma_0_species = half width at half maximum (HWHM) (cm−1/atm) at Tref=296K and reference pressure pref=1atm for a given diluent (air, self, CO2, etc.)</p>
<p>n_gamma0_species = The coefficient of the temperature dependence of the half width</p>
<p>delta_0_species = The pressure shift (cm−1/atm) at Tref=296K and pref=1atm of the line position with respect to the vacuum transition wavenumber νij</p>
<p>n_delta0_species = the coefficient of the temperature dependence of the pressure shift</p>
<p>SD_gamma_species = the ratio of the speed dependent width to the half-width at reference temperature and pressure</p>
<p>n_gamma2_species = the coefficient of the temperature dependence of the speed dependent width NOTE: This is the temperature dependence of the speed dependent width not the ratio of the speed dependence to the half-width</p>
<p>SD_delta_species = the ratio of the speed dependent shift to the collisional shift at reference temperature and pressure</p>
<p>n_delta2_species = the coefficient of the temperature dependence of the speed dependent shift NOTE: This is the temperature dependence of the speed dependent shift not the ratio of the speed dependence to the shift</p>
<p>nuVC_species = dicke narrowing term at reference temperature</p>
<p>n_nuVC_species = coefficient of the temperature dependence of the dicke narrowing term</p>
<p>eta_species = the correlation parameter for the VC and SD effects</p>
<p>y_species_nominaltemperature = linemixing term (as currently written this doesn’t have a temperature dependence, so read in a different column for each nominal temperature)</p>
</dd>
</dl>
</p></li>
<li><p><strong>waves</strong> (<em>array</em>) – 1-D array comprised of wavenumbers (cm-1) to use as x-axis for simulation.</p></li>
<li><p><strong>wing_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – number of half-widths for each line to be calculated for. The default is 50.</p></li>
<li><p><strong>wing_wavenumbers</strong> (<em>float</em><em>, </em><em>optional</em>) – number of wavenumber for each line to be calculated. The default is 50.</p></li>
<li><p><strong>wing_method</strong> (<em>str</em><em>, </em><em>optional</em>) – defines which wing cut-off option to use.  Options are wing_cutoff or wing_wavenumbers The default is ‘wing_cutoff’.</p></li>
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>optional</em>) – pressure for simulation in atmospheres. The default is 1.</p></li>
<li><p><strong>T</strong> (<em>float</em><em>, </em><em>optional</em>) – temperature for simulation in kelvin. The default is 296.</p></li>
<li><p><strong>molefraction</strong> (<em>dict</em><em>, </em><em>optional</em>) – takes the form {molecule_id : mole fraction, molecule_id: mole fraction, …}. The default is {}.</p></li>
<li><p><strong>natural_abundance</strong> (<em>bool</em><em>, </em><em>optional</em>) – True indicates the sample is at natural abundance. The default is True.</p></li>
<li><p><strong>abundance_ratio_MI</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – If sample is not at natural abundance, then the natural abundance defines the enrichment factor compared to natural abundance(ie a sample where the main isotope is the only isotope would have a 1/natural abundance as the enrichment factor). Defined as {M:{I:enrichment factor, I: enrichment factor, I: enrichment factor}, … }. The default is {}.</p></li>
<li><p><strong>Diluent</strong> (<em>dict</em><em>, </em><em>optional</em>) – contains the species as the key with the value being the abundance of that diluent in the sample, ie {‘He’:0.5, ‘self’:0.5}. The default is {}.</p></li>
<li><p><strong>diluent</strong> (<em>str</em><em>, </em><em>optional</em>) – If Diluent = {}, then this value will be used to set the only diluent to be equal to this diluent. The default is ‘air’.</p></li>
<li><p><strong>IntensityThreshold</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum line intensity that will be simulated. The default is 1e-30.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wavenumbers</strong> (<em>array</em>) – wavenumber axis that should match the input waves</p></li>
<li><p><strong>xsect</strong> (<em>array</em>) – simulated cross section as a function of wavenumbers (ppm/cm)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="MATS.Spectrum">
<em class="property">class </em><code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">Spectrum</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">molefraction={}</em>, <em class="sig-param">natural_abundance=True</em>, <em class="sig-param">diluent='air'</em>, <em class="sig-param">Diluent={}</em>, <em class="sig-param">abundance_ratio_MI={}</em>, <em class="sig-param">spectrum_number=1</em>, <em class="sig-param">input_freq=True</em>, <em class="sig-param">input_tau=True</em>, <em class="sig-param">pressure_column='Cavity Pressure /Torr'</em>, <em class="sig-param">temperature_column='Cavity Temperature Side 2 /C'</em>, <em class="sig-param">frequency_column='Total Frequency /MHz'</em>, <em class="sig-param">tau_column='Mean tau/us'</em>, <em class="sig-param">tau_stats_column=None</em>, <em class="sig-param">segment_column=None</em>, <em class="sig-param">etalons={}</em>, <em class="sig-param">nominal_temperature=296</em>, <em class="sig-param">x_shift=0</em>, <em class="sig-param">baseline_order=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Spectrum class provides all information describing experimental or simulated spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – file containing spectrum with .csv extension. File extension is not included in the name</p></li>
<li><p><strong>molefraction</strong> (<em>dict</em>) – mole fraction of each molecule in spectra in the format {molec_id: mole fraction (out of 1), molec_id: molefraction, … }</p></li>
<li><p><strong>natural_abundance</strong> (<em>bool</em><em>, </em><em>optional</em>) – flag for if the molecular species in the spectrum are at natural abundance</p></li>
<li><p><strong>abundance_ratio_MI</strong> (<em>dict</em><em>, </em><em>optional</em>) – if not at natural abundance sets the enhancement factor for each molecule and isotope in the following format {molec_id:{iso_id: enhancement, iso_id: enhancement}, … }</p></li>
<li><p><strong>diluent</strong> (<em>str</em><em>, </em><em>optional</em>) – sets the diluent for the sample.  Default = ‘air’</p></li>
<li><p><strong>Diluent</strong> (<em>dict</em><em>, </em><em>optional</em>) – sets the diluent for the sample if there are a combination of several diluents. Format {‘he’: 0.5, ‘air’: 0.5). NOTE: the line parameter file must have parameters that correspond to the diluent (ie gamma0_he, and gamma0_air). Additionally, the contribution from all diluents must sum to 1.</p></li>
<li><p><strong>spectrum_number</strong> (<em>int</em><em>, </em><em>optional</em>) – sets a number for the spectrum that will correspond to fit parameters. This is set in the Dataset class, so should not need to be defined manually</p></li>
<li><p><strong>input_freq</strong> (<em>bool</em><em>, </em><em>optional</em>) – True indicates that the frequency_column is in MHz. False indicates that the frequency column is in wavenumbers.</p></li>
<li><p><strong>input_tau</strong> (<em>bool</em><em>, </em><em>optional</em>) – True indicates that the tau_column is in us. False indicates that the tau column is in 1/c*tau (ppm/cm).</p></li>
<li><p><strong>pressure_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the pressure column in input file. Column should be in torr. Default is Cavity Pressure /Torr.</p></li>
<li><p><strong>temperature_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the temperature column in input file. Column should be in celsius. Default is Cavity Temperature Side 2 /C.</p></li>
<li><p><strong>frequency_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the frequency column in input file. Column should be in MHz or Wavenumbers (with appropriate flag for input_freq). NOTE: This is not a detuning axis. Default is Total Frequency /MHz.</p></li>
<li><p><strong>tau_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the tau column in input file. Column should be in us or in 1/ctau (ppm/cm) (with appropriate flag for input_tau). Default is Mean tau/us.</p></li>
<li><p><strong>tau_stats_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the tau stats column in input file. Default is ‘tau rel. std. dev./%</p></li>
<li><p><strong>segment_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of column with segment numbers in input file. This column allows spectrum background parameters to be treated in segments across the spectrum. If None then the entire spectrum will share the same segment.</p></li>
<li><p><strong>etalons</strong> (<em>dict</em><em>, </em><em>optional</em>) – Allows you to define etalons by an amplitude and period (1/ frequency in cm-1). Default is no etalons. Input is dictionary with keys being a number and the value being an array with the first index being the amplitude and the second being the period.</p></li>
<li><p><strong>nominal_temperature</strong> (<em>int</em><em>, </em><em>optional</em>) – nominal temperature indicates the approximate temperature of the spectrum. When combining spectra into a dataset this acts as a flag to whether temperature dependence terms should be parameters that can be fit or whether they should act as constants.  Default = 296</p></li>
<li><p><strong>x_shift</strong> (<em>float</em><em>, </em><em>optional</em>) – value in wavenumbers of the x shift for the spectrum axis. This is a fittable parameter. Be careful in using this parameter as floating multiple parameters with similar effects cause fits to not converge (ie. unconstrained line centers + x_shift or fits with line center, shifts, and x_shifts terms without enough lines per spectrum to isolate the different effects). Floating this term works best if you have a good initial guess. Default = 0</p></li>
<li><p><strong>baseline_order</strong> (<em>int</em><em>, </em><em>optional</em>) – sets the baseline order for this spectrum. Allows you to change the baseline order across the broader dataset.()</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MATS.Spectrum.calculate_QF">
<code class="sig-name descname">calculate_QF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.calculate_QF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.calculate_QF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the quality of fit factor (QF) for a spectrum - QF = (maximum alpha - minimum alpha) / std(residuals).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>QF.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.diluent_sum_check">
<code class="sig-name descname">diluent_sum_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.diluent_sum_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.diluent_sum_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that if multiple broadeners are used that the contributions sum to one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Warning if the diluents don’t sum to one</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.fft_spectrum">
<code class="sig-name descname">fft_spectrum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.fft_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.fft_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the FFT of the residuals of the spectrum, generates a plot of frequency (cm-1) versus amplitude (ppm/cm), and prints a dataframe with the 20 highest amplitude frequencies with the FFT frequency (period), amplitude, FFT phase, and frequency (cm-1).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_Diluent">
<code class="sig-name descname">get_Diluent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_Diluent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_Diluent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_abundance_ratio_MI">
<code class="sig-name descname">get_abundance_ratio_MI</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_abundance_ratio_MI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_abundance_ratio_MI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_alpha">
<code class="sig-name descname">get_alpha</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_background">
<code class="sig-name descname">get_background</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_diluent">
<code class="sig-name descname">get_diluent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_diluent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_diluent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_etalons">
<code class="sig-name descname">get_etalons</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_etalons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_etalons" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_filename">
<code class="sig-name descname">get_filename</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_frequency">
<code class="sig-name descname">get_frequency</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_model">
<code class="sig-name descname">get_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_molefraction">
<code class="sig-name descname">get_molefraction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_molefraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_molefraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_natural_abundance">
<code class="sig-name descname">get_natural_abundance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_natural_abundance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_natural_abundance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_nominal_temperature">
<code class="sig-name descname">get_nominal_temperature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_nominal_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_nominal_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_pressure">
<code class="sig-name descname">get_pressure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_pressure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_pressure_torr">
<code class="sig-name descname">get_pressure_torr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_pressure_torr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_pressure_torr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_residuals">
<code class="sig-name descname">get_residuals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_residuals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_spectrum_number">
<code class="sig-name descname">get_spectrum_number</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_spectrum_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_spectrum_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_tau">
<code class="sig-name descname">get_tau</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_tau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_tau_stats">
<code class="sig-name descname">get_tau_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_tau_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_tau_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_temperature">
<code class="sig-name descname">get_temperature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_temperature_C">
<code class="sig-name descname">get_temperature_C</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_temperature_C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_temperature_C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.get_wavenumber">
<code class="sig-name descname">get_wavenumber</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.get_wavenumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.get_wavenumber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.plot_freq_tau">
<code class="sig-name descname">plot_freq_tau</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.plot_freq_tau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.plot_freq_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot of tau (us) as a function of frequency (MHz).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.plot_model_residuals">
<code class="sig-name descname">plot_model_residuals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.plot_model_residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.plot_model_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot of the alpha and model (ppm/cm) as a function of wavenumber (cm-1) and on lower plot shows the residuals (ppm/cm) as a function of wavenumber (cm-1).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.plot_wave_alpha">
<code class="sig-name descname">plot_wave_alpha</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.plot_wave_alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.plot_wave_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot of alpha (ppm/cm) as a function of wavenumber (cm-1).</p>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.save_spectrum_info">
<code class="sig-name descname">save_spectrum_info</code><span class="sig-paren">(</span><em class="sig-param">save_file=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.save_spectrum_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.save_spectrum_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves spectrum information to a pandas dataframe with option to also save as as a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>save_file</strong> (<em>bool</em><em>, </em><em>optional</em>) – If False, then only a dataframe is created. If True, then a csv file will be generated with the name filename + ‘_saved.csv’. The default is False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_file</strong> – returns a pandas dataframe with columns related to the spectrum information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.segment_wave_alpha">
<code class="sig-name descname">segment_wave_alpha</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.segment_wave_alpha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.segment_wave_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the wavenumber, alpha, and indices of spectrum that correspond to a given spectrum segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>wavenumber_segments</strong> (<em>dict</em>) – dictionary where the key corresponds to a segment number and the values correspond to the wavenumbers for that segment</p></li>
<li><p><strong>alpha_segments</strong> (<em>dict</em>) – dictionary where the key corresponds to a segment number and the values correspond to the alpha values for that segment.</p></li>
<li><p><strong>indices_segments</strong> (<em>dict</em>) – dictionary where the key corresponds to a segment number and the values correspond to the array indices for that segment.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_Diluent">
<code class="sig-name descname">set_Diluent</code><span class="sig-paren">(</span><em class="sig-param">new_Diluent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_Diluent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_Diluent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_abundance_ration_MI">
<code class="sig-name descname">set_abundance_ration_MI</code><span class="sig-paren">(</span><em class="sig-param">new_abundance_ratio_MI</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_abundance_ration_MI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_abundance_ration_MI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_background">
<code class="sig-name descname">set_background</code><span class="sig-paren">(</span><em class="sig-param">new_background</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_diluent">
<code class="sig-name descname">set_diluent</code><span class="sig-paren">(</span><em class="sig-param">new_diluent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_diluent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_diluent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_etalons">
<code class="sig-name descname">set_etalons</code><span class="sig-paren">(</span><em class="sig-param">new_etalons</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_etalons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_etalons" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_frequency_column">
<code class="sig-name descname">set_frequency_column</code><span class="sig-paren">(</span><em class="sig-param">new_frequency_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_frequency_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_frequency_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_model">
<code class="sig-name descname">set_model</code><span class="sig-paren">(</span><em class="sig-param">new_model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_molefraction">
<code class="sig-name descname">set_molefraction</code><span class="sig-paren">(</span><em class="sig-param">new_molefraction</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_molefraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_molefraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_natural_abundance">
<code class="sig-name descname">set_natural_abundance</code><span class="sig-paren">(</span><em class="sig-param">new_natural_abundance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_natural_abundance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_natural_abundance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_nominal_temperature">
<code class="sig-name descname">set_nominal_temperature</code><span class="sig-paren">(</span><em class="sig-param">new_nominal_temperature</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_nominal_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_nominal_temperature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_pressure_column">
<code class="sig-name descname">set_pressure_column</code><span class="sig-paren">(</span><em class="sig-param">new_pressure_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_pressure_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_pressure_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_residuals">
<code class="sig-name descname">set_residuals</code><span class="sig-paren">(</span><em class="sig-param">new_residuals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_residuals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_spectrum_number">
<code class="sig-name descname">set_spectrum_number</code><span class="sig-paren">(</span><em class="sig-param">new_spectrum_number</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_spectrum_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_spectrum_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_tau_column">
<code class="sig-name descname">set_tau_column</code><span class="sig-paren">(</span><em class="sig-param">new_tau_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_tau_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_tau_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_tau_stats_column">
<code class="sig-name descname">set_tau_stats_column</code><span class="sig-paren">(</span><em class="sig-param">new_tau_stats_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_tau_stats_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_tau_stats_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MATS.Spectrum.set_temperature_column">
<code class="sig-name descname">set_temperature_column</code><span class="sig-paren">(</span><em class="sig-param">new_temperature_column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#Spectrum.set_temperature_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.Spectrum.set_temperature_column" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="MATS.etalon">
<code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">etalon</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">amp</em>, <em class="sig-param">freq</em>, <em class="sig-param">phase</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#etalon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.etalon" title="Permalink to this definition">¶</a></dt>
<dd><p>Etalon definition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – array of floats used to define the x-axis</p></li>
<li><p><strong>amp</strong> (<em>float</em>) – amplitude of the etalon.</p></li>
<li><p><strong>freq</strong> (<em>float</em>) – period of the etalon.</p></li>
<li><p><strong>phase</strong> (<em>float</em>) – phase of the etalon.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>etalon</strong> – etalon as a function of input x-axis, amplitude, period, and phase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="MATS.hasNumbers">
<code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">hasNumbers</code><span class="sig-paren">(</span><em class="sig-param">inputString</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#hasNumbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.hasNumbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether there are numbers in a string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputString</strong> (<em>str</em>) – string for analysis</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="MATS.max_iter">
<code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">max_iter</code><span class="sig-paren">(</span><em class="sig-param">pars</em>, <em class="sig-param">iter</em>, <em class="sig-param">resid</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#max_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to stop fitting if the number of iterations is greater that 2500</p>
</dd></dl>

<dl class="function">
<dt id="MATS.simulate_spectrum">
<code class="sig-prename descclassname">MATS.</code><code class="sig-name descname">simulate_spectrum</code><span class="sig-paren">(</span><em class="sig-param">parameter_linelist, wave_min, wave_max, wave_space, wave_error=0, SNR=None, baseline_terms=[0], temperature=25, temperature_err={'bias': 0, 'function': None, 'params': {}}, pressure=760, pressure_err={'function': None, 'params': {}, 'per_bias': 0}, wing_cutoff=25, wing_wavenumbers=25, wing_method='wing_cutoff', filename='temp', molefraction={}, molefraction_err={}, natural_abundance=True, abundance_ratio_MI={}, diluent='air', Diluent={}, nominal_temperature=296, etalons={}, x_shift=0, IntensityThreshold=1e-30, num_segments=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MATS.html#simulate_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MATS.simulate_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a synthetic spectrum, where the output is a spectrum object that can be used in MATS classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter_linelist</strong> (<em>dataframe</em>) – linelist following the convention of the linelists used for the HTP_from_DF_select.  Note that there will need to be a linemixing column for each nominal temperature, which you will have to do manually (ie y_air_296, y_self_296).</p></li>
<li><p><strong>wave_min</strong> (<em>float</em>) – minimum wavenumber for the simulation (cm-1)</p></li>
<li><p><strong>wave_max</strong> (<em>float</em>) – maximum wavenumber for the simulation (cm-1).</p></li>
<li><p><strong>wave_space</strong> (<em>float</em>) – wavenumber spacing for the simulation (cm-1).</p></li>
<li><p><strong>wave_error</strong> (<em>float</em><em>, </em><em>optional</em>) – absolute error on the wavenumber axis (cm-1) to include in simulations. The default is 0.</p></li>
<li><p><strong>SNR</strong> (<em>float</em><em>, </em><em>optional</em>) – Signal to noise ratio to impose on the simulated spectrum. The default is None.  If SNR is none there is no noise on the simulation.</p></li>
<li><p><strong>baseline_terms</strong> (<em>list</em><em>, </em><em>optional</em>) – polynomial baseline coefficients where the index is equal to the coefficient order, ie. [0, 1, 2] would correspond to baseline = 0 + 1*(wavenumber - minimum wavenumber) + 2*(wavenumber - minimum wavenumber)^2. The default is [0].</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – temperature for simulation in celsius. The default is 25.</p></li>
<li><p><strong>temperature_err</strong> (<em>dict</em><em>, </em><em>optional</em>) – possible keys include ‘bias’, ‘function’, and ‘params’. The bias indicates the absolute bias in Celsius of the temperature reading, which will be added to the input temperature. Function can be ‘linear’ with params ‘m’ and ‘b’ or ‘sine’ with parameters ‘amp’, ‘freq’, and ‘phase’. These define a function that is added to both the bias and set temperature as a function of the wavenumber. Note: if ‘function’ key is not equal to None, then there also needs to be a params key to define the function.. The default is {‘bias’: 0, ‘function’: None, ‘params’: {}}.</p></li>
<li><p><strong>pressure</strong> (<em>float</em><em>, </em><em>optional</em>) – pressure for simulation in torr. The default is 760.</p></li>
<li><p><strong>pressure_err</strong> (<em>dict</em><em>, </em><em>optional</em>) – possible keys include bias, function, and params. The bias indicates the percent bias in of the pressure reading, which will be added to the input pressure. Function can be ‘linear’ with params ‘m’ and ‘b’ or ‘sine’ with parameters ‘amp’, ‘freq’, and ‘phase’. These define a function that is added to both the bias and set pressure as a function of the wavenumber. Note: if ‘function’ key is not equal to None, then there also needs to be a params key to define the function.. The default is {‘per_bias’: 0, ‘function’: None, ‘params’: {}}.</p></li>
<li><p><strong>wing_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – number of voigt half-widths to simulate on either side of each line. The default is 25.</p></li>
<li><p><strong>wing_wavenumbers</strong> (<em>float</em><em>, </em><em>optional</em>) – number of wavenumbers to simulate on either side of each line. The default is 25.</p></li>
<li><p><strong>wing_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Provides choice between the wing_cutoff and wing_wavenumbers line cut-off options. The default is ‘wing_cutoff’.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – allows you to pick the output filename for the simulated spectra. The default is ‘temp’.</p></li>
<li><p><strong>molefraction</strong> (<em>dict</em><em>, </em><em>optional</em>) – mole fraction of each molecule to be simulated in the spectrum in the format {molec_id: mole fraction (out of 1), molec_id: molefraction, … }. The default is {}.</p></li>
<li><p><strong>molefraction_err</strong> (<em>dict</em><em>, </em><em>optional</em>) – percent error in the mole fraction of each molecule to be simulated in the spectrum in the format {molec_id: percent error in mole fraction, molec_id: percent error in mole fraction, … }. The default is {}.</p></li>
<li><p><strong>natural_abundance</strong> (<em>bool</em><em>, </em><em>optional</em>) – flag for if the spectrum contains data at natural abundance. The default is True.</p></li>
<li><p><strong>abundance_ratio_MI</strong> (<em>dict</em><em>, </em><em>optional</em>) – if not at natural abundance sets the enhancement factor for each molecule and isotope in the following format {molec_id:{iso_id: enhancement, iso_id: enhancement}, … }. The default is {}.</p></li>
<li><p><strong>diluent</strong> (<em>str</em><em>, </em><em>optional</em>) – sets the diluent for the sample if only using one broadener. The default is ‘air’.</p></li>
<li><p><strong>Diluent</strong> (<em>dict</em><em>, </em><em>optional</em>) – sets the diluent for the sample if there are a combination of several. Format {‘he’: 0.5, ‘air’: 0.5). NOTE: the line parameter file must have parameters that correspond to the diluent (ie gamma0_he, and gamma0_air). Additionally, the contribution from all diluents must sum to 1.. The default is {}.</p></li>
<li><p><strong>nominal_temperature</strong> (<em>int</em><em>, </em><em>optional</em>) – nominal temperature indicates the approximate temperature of the spectrum. When combining spectra into a dataset this acts as a flag to whether temperature dependence terms should be parameters that can be fit or whether they should act as constants.. The default is 296.</p></li>
<li><p><strong>etalons</strong> (<em>dict</em><em>, </em><em>optional</em>) – Allows you to define etalons by an amplitude and period (1/ frequency in cm-1). Default is no etalons. Input is dictionary with keys being a number and the value being an array with the first index being the amplitude and the second being the period.. The default is {}.</p></li>
<li><p><strong>x_shift</strong> (<em>float</em><em>, </em><em>optional</em>) – value in wavenumbers of the x shift for the spectrum axis.. The default is 0.</p></li>
<li><p><strong>IntensityThreshold</strong> (<em>float</em><em>, </em><em>optional</em>) – minimum line intensity to use in the simulation. The default is 1e-30.</p></li>
<li><p><strong>num_segments</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Number of segments in the file, which is implemented labeling the segment column into equal sequential se . The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spectrum_file</strong> (<em>.csv</em>) – File that contains the simulated wavenumber axis, noisy wavenumber axis, absorbance data, noisy absorbance data, pressure (torr), and temperature (C). The filename will correspond to the filename parameter, which has a default value of temp. The pressure and temperature columns will include whatever functional change there is to the pressure or temperature, but not the bias offset. This is coded to match how this error would manifest in experiments.</p></li>
<li><p><strong>spectrum_object</strong> (<em>object</em>) – Outputs a Spectrum class object. This makes it so the you can easily switch between reading in an experimental spectrum and simulated a synthetic spectrum by simply switching out whether the spectrum object is defined through the class definition or through the simulate_spectrum function.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="MATS Example using Experimental and Synthetic Data.html"
                        title="previous chapter">MATS Example using Experimental and Synthetic Data</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="MATS Example using Experimental and Synthetic Data.html" title="MATS Example using Experimental and Synthetic Data"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MATS 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>