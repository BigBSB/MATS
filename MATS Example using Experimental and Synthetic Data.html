
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>MATS Example using Experimental and Synthetic Data &#8212; MATS 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
    <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
    <script src="https://code.jquery.com/jquery.1.12.4.min.js"></script>
    <script src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
    <script src="_static/leave_notice.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MATS module" href="MATS.html" />
    <link rel="prev" title="Generating Parameter Line lists" href="Generating Parameter Line lists.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="mats-example-using-experimental-and-synthetic-data">
<h1>MATS Example using Experimental and Synthetic Data<a class="headerlink" href="#mats-example-using-experimental-and-synthetic-data" title="Permalink to this headline">¶</a></h1>
<p>Provided in the MATS v1.0 release are two examples for using MATS in the Oxygen A-Band.  The first uses <a class="reference external" href="https://github.com/usnistgov/MATS/tree/master/MATS/Examples/A-Band%20-%20Experimental%20Spectra">Experimental Spectra</a> and the second uses <a class="reference external" href="https://github.com/usnistgov/MATS/tree/master/MATS/Examples/A-Band%20-%20Synthetic%20Spectra">Synthetic Spectra</a>.  In this overview, we will walk through the common elements of both examples and highlight the differeneces between using experimental data and simulated spectra generated through the <a class="reference internal" href="MATS.html#MATS.simulate_spectrum" title="MATS.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.simulate_spectrum()</span></code></a> function.</p>
<div class="section" id="import-modules-and-set-up">
<h2>Import Modules and Set-Up<a class="headerlink" href="#import-modules-and-set-up" title="Permalink to this headline">¶</a></h2>
<p>Both examples start with importing modules and setting up locations</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">qgrid</span> <span class="c1"># only need if using the edit MATS.Edit_Fit_Param_Files class</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>
</pre></div>
</div>
<p>Append the system path to include the location of both the hapi and MATS modules</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\Documents\MATS\MATS&#39;</span><span class="p">)</span><span class="c1"># set location of HAPI.py module</span>

<span class="kn">from</span> <span class="nn">hapi</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">MATS</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Change the path to the working directory that contains experimental spectra (if using).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Documents\MATS\MATS\Examples\A-Band - Experimental Spectra&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="load-spectra-from-files">
<h2>Load Spectra from files<a class="headerlink" href="#load-spectra-from-files" title="Permalink to this headline">¶</a></h2>
<p>There are two options for generating <a class="reference internal" href="MATS.html#MATS.Spectrum" title="MATS.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Spectrum</span></code></a> objects.  The first is from a file by instantiating an instance of the class.  The second option is by the <a class="reference internal" href="MATS.html#MATS.simulate_spectrum" title="MATS.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.simulate_spectrum()</span></code></a> function described in the following section.</p>
<p>Before generating <a class="reference internal" href="MATS.html#MATS.Spectrum" title="MATS.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Spectrum</span></code></a> objects from your experimental data, it is helpful to set some variables for terms that will be used in several of the generated spectrum objects or throughout the fiting.  In this example the minimum intensity threshold for simulation (IntensityThreshold), the minimum line intensity of lines to be fit in the analysis (Fit_Intensity), the order of the polynomial to be used in the baseline fits, and the names of columns to be used for the absorption, frequency, pressure, and temperature data are defined at the top of the example.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave_range</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1">#range outside of experimental x-range to simulate</span>
<span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span> <span class="c1">#intensities must be above this value to be simulated</span>
<span class="n">Fit_Intensity</span> <span class="o">=</span> <span class="mf">1e-24</span> <span class="c1">#intensities must be above this value for the line to be fit</span>
<span class="n">order_baseline_fit</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tau_column</span> <span class="o">=</span> <span class="s1">&#39;Corrected Tau (us)&#39;</span> <span class="c1"># Mean tau/us</span>
<span class="n">freq_column</span> <span class="o">=</span> <span class="s1">&#39;Total Frequency (Detuning)&#39;</span> <span class="c1"># Total Frequency /MHz</span>
<span class="n">pressure_column</span> <span class="o">=</span> <span class="s1">&#39;Cavity Pressure /Torr&#39;</span>
<span class="n">temperature_column</span> <span class="o">=</span> <span class="s1">&#39;Cavity Temperature Side 2 /C&#39;</span>
</pre></div>
</div>
<p>After that 4 instances of the <a class="reference internal" href="MATS.html#MATS.Spectrum" title="MATS.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Spectrum</span></code></a> class are generated from 4 experimental spectrum.  In the class instantiation, the molefraction of the oxygen sample used is defined, the etalon amplitude and period are defined, the sample is confirmed to be at natural abundance, the diluent is set to air, and the columns defined for pressure, temperature, frequency, and absorbance data are set.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec_1</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;190510_2per_43_forfit&#39;</span><span class="p">,</span>
                     <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">7</span> <span class="p">:</span><span class="mf">0.01949</span><span class="p">},</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mf">0.001172</span><span class="p">,</span> <span class="mf">1.19574</span><span class="p">]},</span>
                     <span class="n">input_freq</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frequency_column</span> <span class="o">=</span> <span class="n">freq_column</span><span class="p">,</span>
                     <span class="n">input_tau</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tau_column</span> <span class="o">=</span> <span class="n">tau_column</span><span class="p">,</span> <span class="n">tau_stats_column</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">pressure_column</span> <span class="o">=</span> <span class="n">pressure_column</span><span class="p">,</span> <span class="n">temperature_column</span> <span class="o">=</span> <span class="n">temperature_column</span><span class="p">,</span>
                     <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">x_shift</span> <span class="o">=</span> <span class="mf">0.00</span><span class="p">)</span>
<span class="n">spec_2</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;190510_2per_55_forfit&#39;</span><span class="p">,</span>
                     <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">7</span> <span class="p">:</span> <span class="mf">0.01949</span><span class="p">},</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mf">0.001172</span><span class="p">,</span> <span class="mf">1.19574</span><span class="p">]},</span>
                     <span class="n">input_freq</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frequency_column</span> <span class="o">=</span> <span class="n">freq_column</span><span class="p">,</span>
                     <span class="n">input_tau</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tau_column</span> <span class="o">=</span> <span class="n">tau_column</span><span class="p">,</span> <span class="n">tau_stats_column</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">pressure_column</span> <span class="o">=</span> <span class="n">pressure_column</span><span class="p">,</span> <span class="n">temperature_column</span> <span class="o">=</span> <span class="n">temperature_column</span><span class="p">,</span>
                     <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">x_shift</span> <span class="o">=</span> <span class="mf">0.00</span><span class="p">)</span>
<span class="n">spec_3</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;190513_2per_82_forfit&#39;</span><span class="p">,</span>
                     <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">7</span> <span class="p">:</span><span class="mf">0.01949</span><span class="p">},</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mf">0.001172</span><span class="p">,</span> <span class="mf">1.19574</span><span class="p">]},</span>
                     <span class="n">input_freq</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frequency_column</span> <span class="o">=</span> <span class="n">freq_column</span><span class="p">,</span>
                     <span class="n">input_tau</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tau_column</span> <span class="o">=</span> <span class="n">tau_column</span><span class="p">,</span> <span class="n">tau_stats_column</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">pressure_column</span> <span class="o">=</span> <span class="n">pressure_column</span><span class="p">,</span> <span class="n">temperature_column</span> <span class="o">=</span> <span class="n">temperature_column</span><span class="p">,</span>
                     <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">x_shift</span> <span class="o">=</span> <span class="mf">0.00</span><span class="p">)</span>
<span class="n">spec_4</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;190514_2per_126_forfit&#39;</span><span class="p">,</span>
                     <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">7</span> <span class="p">:</span><span class="mf">0.01949</span><span class="p">},</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mf">0.001172</span><span class="p">,</span> <span class="mf">1.19574</span><span class="p">]},</span>
                     <span class="n">input_freq</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frequency_column</span> <span class="o">=</span> <span class="n">freq_column</span><span class="p">,</span>
                     <span class="n">input_tau</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">tau_column</span> <span class="o">=</span> <span class="n">tau_column</span><span class="p">,</span> <span class="n">tau_stats_column</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">pressure_column</span> <span class="o">=</span> <span class="n">pressure_column</span><span class="p">,</span> <span class="n">temperature_column</span> <span class="o">=</span> <span class="n">temperature_column</span><span class="p">,</span>
                     <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">x_shift</span> <span class="o">=</span> <span class="mf">0.00</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="MATS.html#MATS.Spectrum.plot_wave_alpha" title="MATS.Spectrum.plot_wave_alpha"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Spectrum.plot_wave_alpha()</span></code></a> function is called to plot one of the spectra.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec_1</span><span class="o">.</span><span class="n">plot_wave_alpha</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot_wave_alpha.png" src="_images/plot_wave_alpha.png" />
</div>
<div class="section" id="simulate-spectra">
<h2>Simulate Spectra<a class="headerlink" href="#simulate-spectra" title="Permalink to this headline">¶</a></h2>
<p>If you are simulating spectra, opposed to reading them in the from a file then you can use the <a class="reference internal" href="MATS.html#MATS.simulate_spectrum" title="MATS.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.simulate_spectrum()</span></code></a> function.</p>
<p>When simulating spectra, the first step is to read in the refence line list, so the following code reads in the reference line list as a pandas dataframe and then resets the working directory,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hapi</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Documents\MATS\MATS\Linelists&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">hapi</span><span class="p">)</span>
<span class="n">PARAM_LINELIST</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;O2_ABand_Drouin_2017_linelist.csv&#39;</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Documents\MATS\MATS\Examples\A-Band - Synthetic Spectra&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Just as you would do if reading in the experimental spectrum, this example defines some common simulation and fit variables.  In addition to some defined above, the minimum and maximum wavenumbers for the simulation and the wavenumber spacing are defined.  The baseline (defined by polynomial where the array index is the parameter coefficient order).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wave_range</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1">#range outside of experimental x-range to simulate</span>
<span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span> <span class="c1">#intensities must be above this value to be simulated</span>
<span class="n">Fit_Intensity</span> <span class="o">=</span> <span class="mf">1e-24</span> <span class="c1">#intensities must be above this value for the line to be fit</span>
<span class="n">order_baseline_fit</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sample_molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span> <span class="p">:</span><span class="mf">0.002022</span><span class="p">}</span>
<span class="n">wave_min</span> <span class="o">=</span> <span class="mi">13155</span> <span class="c1">#cm-1</span>
<span class="n">wave_max</span> <span class="o">=</span> <span class="mf">13157.5</span> <span class="c1">#cm-1</span>
<span class="n">wave_space</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1">#cm-1</span>
<span class="n">baseline_terms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#polynomial baseline coefficients where the index is equal to the coefficient order</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="MATS.html#MATS.simulate_spectrum" title="MATS.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.simulate_spectrum()</span></code></a> function also allows for error to be added to the absorption axis through SNR, the wavenumber axis through the wave_err parameter, and the temperature and pressure through the temperature_err and pressure_err dictionaries.  The SNR is manifested by adding  gaussian noise to the spectra such that the (maximum alpha - minimum alpha) / noise is equal to the SNR.  The wavenumber err is a gaussian noise error of that magnitude added to the wavenumber axis.</p>
<p>The molefraction_err is implemented as a percent error on each molecule molefraction, such that the simulated value is off by a constant positve offset from the simulated value(could entrer negative percent error to get negative offset).  This is an attempt to mimic if the maximum impact that a constant error in sample concentration would have.</p>
<p>In experiments we have two type of errors with our pressure and temperature measurements.  The first is a constant bias or error in the reading.  The second type of error is an actual change in the value during the collection of the spectrum.  To account for this the pressure_err and temperature_err are dictionaries, where the keys correspond to ‘bias/per_bias’ (bias for temperature and per_bias for pressure), function (allows ‘linear’ or ‘sine’) and params.  If the function is ‘linear’ then param keys are ‘m’ and ‘b’ corresponding to the slope and interecept. If the function is ‘sine’ then the param keys are ‘amp’, ‘freq’, and ‘phase’ corresponding to the amplitude, period, and phase of the etalon.  For both temperature and pressure, the recorded pressure/temperature includes the average pressure or temperature over the segment (representing the frequency of the measurement in an experiment) and does not include the bias.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SNR</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">wave_error</span> <span class="o">=</span> <span class="mf">5e-5</span>
<span class="n">temperature_err</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;bias&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">pressure_err</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;per_bias&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">molefraction_err</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:</span><span class="mf">0.01</span><span class="p">}</span>
</pre></div>
</div>
<p>We can now use this parameters and additional setting for filenames and number of segments to call the <a class="reference internal" href="MATS.html#MATS.simulate_spectrum" title="MATS.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.simulate_spectrum()</span></code></a> function setting the ouput equal to the variables as was done for when the <a class="reference internal" href="MATS.html#MATS.Spectrum" title="MATS.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Spectrum</span></code></a> was used.  This makes it simple to transition code from analysis of experimental spectra to error analysis through simulations.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec_1</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">temperature_err</span> <span class="o">=</span> <span class="n">temperature_err</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                     <span class="n">pressure_err</span> <span class="o">=</span> <span class="n">pressure_err</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_cutoff&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;20_torr&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="n">sample_molefraction</span><span class="p">,</span> <span class="n">molefraction_err</span> <span class="o">=</span> <span class="n">molefraction_err</span><span class="p">,</span>
                     <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">spec_2</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">temperature_err</span> <span class="o">=</span> <span class="n">temperature_err</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
                     <span class="n">pressure_err</span> <span class="o">=</span> <span class="n">pressure_err</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_cutoff&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;40_torr&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="n">sample_molefraction</span><span class="p">,</span> <span class="n">molefraction_err</span> <span class="o">=</span> <span class="n">molefraction_err</span><span class="p">,</span>
                     <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">spec_3</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">temperature_err</span> <span class="o">=</span> <span class="n">temperature_err</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
                     <span class="n">pressure_err</span> <span class="o">=</span> <span class="n">pressure_err</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_cutoff&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;60_torr&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="n">sample_molefraction</span><span class="p">,</span> <span class="n">molefraction_err</span> <span class="o">=</span> <span class="n">molefraction_err</span><span class="p">,</span>
                     <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">spec_4</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">temperature_err</span> <span class="o">=</span> <span class="n">temperature_err</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
                     <span class="n">pressure_err</span> <span class="o">=</span> <span class="n">pressure_err</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_cutoff&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;80_torr&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="n">sample_molefraction</span><span class="p">,</span> <span class="n">molefraction_err</span> <span class="o">=</span> <span class="n">molefraction_err</span><span class="p">,</span>
                     <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-a-dataset">
<h2>Generate a Dataset<a class="headerlink" href="#generate-a-dataset" title="Permalink to this headline">¶</a></h2>
<p>The procedure for analysis for both spectrum class generation methods is the same from this point on.  The next step is to combine all spectrum objects for analysis into a Dataset object, where we give the Dataset a name, and define what order polynomial to use for the baseline fit.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SPECTRA</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">([</span><span class="n">spec_1</span><span class="p">,</span> <span class="n">spec_2</span><span class="p">,</span> <span class="n">spec_3</span><span class="p">,</span> <span class="n">spec_4</span><span class="p">],</span> <span class="s1">&#39;Line Intensity&#39;</span><span class="p">,</span> <span class="n">baseline_order</span> <span class="o">=</span> <span class="n">order_baseline_fit</span><span class="p">)</span>
</pre></div>
</div>
<p>The Dataset class contanes a function to generate a baseline linelist analogous to the one for the parameter linelist based on the order of the baseline fit, etalons, molecules, x-shift parameters and segments as defined by the spectrum and dataset objects.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_LINELIST</span> <span class="o">=</span> <span class="n">SPECTRA</span><span class="o">.</span><span class="n">generate_baseline_paramlist</span><span class="p">()</span>
</pre></div>
</div>
<p>If the parameter line list hasn’t been read in from the .csv file then do that now making sure to switch to and from the appropriate directories as needed.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hapi</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Documents\MATS\MATS\Linelists&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">hapi</span><span class="p">)</span>
<span class="n">PARAM_LINELIST</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;O2_ABand_Drouin_2017_linelist.csv&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-fit-parameter-files">
<h2>Generate Fit Parameter Files<a class="headerlink" href="#generate-fit-parameter-files" title="Permalink to this headline">¶</a></h2>
<p>The next section of code uses the <a class="reference internal" href="MATS.html#MATS.Generate_FitParam_File" title="MATS.Generate_FitParam_File"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Generate_FitParam_File</span></code></a> class to define how what line shape to use for the inital fits, whether to use line mixing, the minimum line intensity to fit a line, mimimum intensity to included in the simulation, and for each line parameter whether that parameter is going to be constrained to the across all spectrum or whether there will be a parameter for each spectrum (multi-spectrum vs single-spectrum fits).  In the example below the SDVP line profile without line mixing will be used as to fit lines with line intensities greater than 1e-24 and the line centers and line intensities will be allowed to float for each line, while all other lines are constrained across all spectra in the dataset.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FITPARAMS</span> <span class="o">=</span> <span class="n">Generate_FitParam_File</span><span class="p">(</span><span class="n">SPECTRA</span><span class="p">,</span> <span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">BASE_LINELIST</span><span class="p">,</span> <span class="n">lineprofile</span> <span class="o">=</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">,</span> <span class="n">linemixing</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                               <span class="n">fit_intensity</span> <span class="o">=</span> <span class="n">Fit_Intensity</span><span class="p">,</span> <span class="n">threshold_intensity</span> <span class="o">=</span> <span class="n">IntensityThreshold</span><span class="p">,</span> <span class="n">sim_window</span> <span class="o">=</span> <span class="n">wave_range</span><span class="p">,</span>
                               <span class="n">nu_constrain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sw_constrain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">gamma0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delta0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">aw_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">as_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">nuVC_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">eta_constrain</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linemixing_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to generate fit parameter and baseline line list that include columns that specify whether that parameter should float or not, in addition to adding error columns for the fit error in that parameter.  The following example shows that the line centers, line intensities, collisional half-widths, and aw terms will be floated for all main oxygen isotopes for lines where the line intensity is greater than 1e-24.  Additionally the baseline terms will float, as will the etalon amplitude and phase.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FITPARAMS</span><span class="o">.</span><span class="n">generate_fit_param_linelist_from_linelist</span><span class="p">(</span><span class="n">vary_nu</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_sw</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_gamma0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_gamma0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">}},</span>
                                                 <span class="n">vary_delta0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_delta0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">}},</span>
                                                 <span class="n">vary_aw</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_gamma2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_as</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_delta2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_nuVC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_nuVC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_eta</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_linemixing</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}})</span>

<span class="n">FITPARAMS</span><span class="o">.</span><span class="n">generate_fit_baseline_linelist</span><span class="p">(</span><span class="n">vary_baseline</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">vary_molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">},</span> <span class="n">vary_xshift</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                   <span class="n">vary_etalon_amp</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">vary_etalon_freq</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_etalon_phase</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>These functions will generate .csv files corresponding to these selections, which are read in by the <a class="reference internal" href="MATS.html#MATS.Fit_DataSet" title="MATS.Fit_DataSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Fit_DataSet</span></code></a> class instantiation.  This means that edits can be made manually to the .csv files or using the <a class="reference internal" href="MATS.html#MATS.Edit_Fit_Param_Files" title="MATS.Edit_Fit_Param_Files"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Edit_Fit_Param_Files</span></code></a> class before the next code segment is run.</p>
</div>
<div class="section" id="fit-dataset">
<h2>Fit Dataset<a class="headerlink" href="#fit-dataset" title="Permalink to this headline">¶</a></h2>
<p>Initializing an instance of the <a class="reference internal" href="MATS.html#MATS.Fit_DataSet" title="MATS.Fit_DataSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">MATS.Fit_DataSet</span></code></a> class reads in the information from the baseline and parameter linelists generated in the previouse step.  It also allows for the limits to placed on the parameters, so that they don’t result in divergent solutions.  The example below includes several limits including limiting the line center to be within 0.1 cm-1 of the initial guess and the Line intensity to be within a factor of 2 of the intial guess.  Placing limits on the parameters can be restrictive on the solution and cause the fit to not converge or return NaN for the Stderrr if it doesn’t allow for a local minima to be found.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">Fit_DataSet</span><span class="p">(</span><span class="n">SPECTRA</span><span class="p">,</span><span class="s1">&#39;Baseline_LineList&#39;</span><span class="p">,</span> <span class="s1">&#39;Parameter_LineList&#39;</span><span class="p">,</span> <span class="n">minimum_parameter_fit_intensity</span> <span class="o">=</span> <span class="n">Fit_Intensity</span><span class="p">,</span>
             <span class="n">baseline_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">baseline_limit_factor</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
             <span class="n">molefraction_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">molefraction_limit_factor</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">,</span>
             <span class="n">etalon_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">etalon_limit_factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1">#phase is constrained to +/- 2pi,</span>
             <span class="n">x_shift_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">x_shift_limit_magnitude</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
             <span class="n">nu_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nu_limit_magnitude</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
             <span class="n">sw_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sw_limit_factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
             <span class="n">gamma0_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">gamma0_limit_factor</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">n_gamma0_limit</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_gamma0_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">delta0_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delta0_limit_factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_delta0_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_delta0_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">SD_gamma_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">SD_gamma_limit_factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_gamma2_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_gamma2_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">SD_delta_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">SD_delta_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">n_delta2_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_delta2_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">nuVC_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nuVC_limit_factor</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_nuVC_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_nuVC_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">eta_limit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">eta_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">linemixing_limit</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">linemixing_limit_factor</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to generate the LMFit params dictionary object through the <a class="reference internal" href="MATS.html#MATS.Fit_DataSet.generate_params" title="MATS.Fit_DataSet.generate_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Fit_DataSet.generate_params()</span></code></a> function.  This translates baseline and parameter linelist .csv files into the LMFit parameter dictionary that is used in the fits.  After the parameters object is generated you can use the keys to set values and impose constraints on individual parameters, if desired.  While this is not coded in the MATS toolkit, it is incredibly powerful as it lets you define min, max, vary, and expr values for any parameter.  In the example below, two additional constraints are imposed on the data the first constrains the aw fit parameters between the values of 0.01 and 0.25 and the second forces the amplitude of the etalon to be constant across all spectrum.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">generate_params</span><span class="p">()</span>



<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
             <span class="k">if</span> <span class="s1">&#39;SD_gamma&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                     <span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">min</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
             <span class="k">if</span> <span class="s1">&#39;etalon_1_amp&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                     <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;etalon_1_amp_1_1&#39;</span><span class="p">:</span>
                             <span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="s1">&#39;etalon_1_amp_1_1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The params file is then used to fit the spectra in the dataset using the <a class="reference internal" href="MATS.html#MATS.Fit_DataSet.fit_data" title="MATS.Fit_DataSet.fit_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Fit_DataSet.fit_data()</span></code></a> function, where the result is a LMFit result object and we can use LMFit prettyprint function to get parameter fit results.  Included below is an abbreviated output that not only shows the fit result values and stderr, but highlights that the constraints were imposed on the SD_gamma parameters and the expression imposed on the etalon_amplitudes.  It also shows that the there is a line intensity reported for every line (suffix number) and the spectrum number (after <a href="#id1"><span class="problematic" id="id2">sw_</span></a>) as the line intensities were not constrained to global fits.  The sw also show that the fitted line intensity value is scaled by the minimum fit value.  This aids in the fitting as line intensities are so much smaller than other values.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">fit_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span>                     <span class="n">Value</span>      <span class="n">Min</span>      <span class="n">Max</span>   <span class="n">Stderr</span>     <span class="n">Vary</span>     <span class="n">Expr</span> <span class="n">Brute_Step</span>
<span class="n">Pressure_1_1</span>           <span class="mf">0.07911</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">Pressure_2_1</span>           <span class="mf">0.06556</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">Pressure_3_1</span>           <span class="mf">0.04602</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">Pressure_4_1</span>           <span class="mf">0.02488</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_delta_air_line_1</span>          <span class="mi">0</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_delta_air_line_10</span>         <span class="mi">0</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_delta_air_line_13</span>         <span class="mi">0</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_delta_air_line_25</span>         <span class="mi">0</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_delta_air_line_26</span>         <span class="mi">0</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_gamma_air_line_1</span>        <span class="mf">0.1</span>     <span class="mf">0.01</span>     <span class="mf">0.25</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_gamma_air_line_10</span>    <span class="mf">0.1137</span>     <span class="mf">0.01</span>     <span class="mf">0.25</span> <span class="mf">0.0008273</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_gamma_air_line_13</span>    <span class="mf">0.1313</span>     <span class="mf">0.01</span>     <span class="mf">0.25</span> <span class="mf">0.001115</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_gamma_air_line_25</span>      <span class="mf">0.09</span>     <span class="mf">0.01</span>     <span class="mf">0.25</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">SD_gamma_air_line_26</span>       <span class="mf">0.1</span>     <span class="mf">0.01</span>     <span class="mf">0.25</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="n">etalon_1_amp_1_1</span>      <span class="mf">0.001762</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">4.007e-05</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_amp_2_1</span>      <span class="mf">0.001762</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">4.007e-05</span>    <span class="kc">False</span> <span class="n">etalon_1_amp_1_1</span>     <span class="kc">None</span>
<span class="n">etalon_1_amp_3_1</span>      <span class="mf">0.001762</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">4.007e-05</span>    <span class="kc">False</span> <span class="n">etalon_1_amp_1_1</span>     <span class="kc">None</span>
<span class="n">etalon_1_amp_4_1</span>      <span class="mf">0.001762</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">4.007e-05</span>    <span class="kc">False</span> <span class="n">etalon_1_amp_1_1</span>     <span class="kc">None</span>
<span class="n">etalon_1_freq_1_1</span>        <span class="mf">1.196</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_freq_2_1</span>        <span class="mf">1.196</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_freq_3_1</span>        <span class="mf">1.196</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_freq_4_1</span>        <span class="mf">1.196</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_phase_1_1</span>     <span class="o">-</span><span class="mf">0.3479</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>  <span class="mf">0.04585</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_phase_2_1</span>    <span class="o">-</span><span class="mf">0.09384</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>  <span class="mf">0.04288</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_phase_3_1</span>       <span class="o">-</span><span class="mf">1.04</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>  <span class="mf">0.04446</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">etalon_1_phase_4_1</span>      <span class="o">-</span><span class="mf">1.266</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>  <span class="mf">0.04394</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">gamma0_air_line_1</span>         <span class="mf">0.04</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">gamma0_air_line_10</span>     <span class="mf">0.04501</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">4.919e-05</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">gamma0_air_line_13</span>     <span class="mf">0.04339</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span> <span class="mf">7.531e-05</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">gamma0_air_line_25</span>        <span class="mf">0.04</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">gamma0_air_line_26</span>        <span class="mf">0.04</span>     <span class="o">-</span><span class="n">inf</span>      <span class="n">inf</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="n">sw_1_line_1</span>              <span class="mf">4.369</span>    <span class="mf">2.184</span>    <span class="mf">8.738</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_1_line_10</span>             <span class="mf">4.735</span>      <span class="mf">2.4</span>    <span class="mf">9.598</span> <span class="mf">0.0008558</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_1_line_13</span>             <span class="mf">3.087</span>    <span class="mf">1.562</span>    <span class="mf">6.246</span> <span class="mf">0.0007302</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_1_line_25</span>             <span class="mf">2.083</span>    <span class="mf">1.042</span>    <span class="mf">4.166</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_1_line_26</span>             <span class="mf">3.399</span>    <span class="mf">1.699</span>    <span class="mf">6.798</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_2_line_1</span>              <span class="mf">4.369</span>    <span class="mf">2.184</span>    <span class="mf">8.738</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_2_line_10</span>             <span class="mf">4.752</span>      <span class="mf">2.4</span>    <span class="mf">9.598</span> <span class="mf">0.0006929</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_2_line_13</span>             <span class="mf">3.091</span>    <span class="mf">1.562</span>    <span class="mf">6.246</span> <span class="mf">0.0006913</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_2_line_25</span>             <span class="mf">2.083</span>    <span class="mf">1.042</span>    <span class="mf">4.166</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_2_line_26</span>             <span class="mf">3.399</span>    <span class="mf">1.699</span>    <span class="mf">6.798</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_3_line_1</span>              <span class="mf">4.369</span>    <span class="mf">2.184</span>    <span class="mf">8.738</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_3_line_10</span>             <span class="mf">4.744</span>      <span class="mf">2.4</span>    <span class="mf">9.598</span> <span class="mf">0.0007446</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_3_line_13</span>             <span class="mf">3.095</span>    <span class="mf">1.562</span>    <span class="mf">6.246</span> <span class="mf">0.0007499</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_3_line_25</span>             <span class="mf">2.083</span>    <span class="mf">1.042</span>    <span class="mf">4.166</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_3_line_26</span>             <span class="mf">3.399</span>    <span class="mf">1.699</span>    <span class="mf">6.798</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_4_line_1</span>              <span class="mf">4.369</span>    <span class="mf">2.184</span>    <span class="mf">8.738</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_4_line_10</span>               <span class="mf">4.8</span>      <span class="mf">2.4</span>    <span class="mf">9.598</span> <span class="mf">0.001158</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_4_line_13</span>             <span class="mf">3.118</span>    <span class="mf">1.562</span>    <span class="mf">6.246</span>  <span class="mf">0.00117</span>     <span class="kc">True</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_4_line_25</span>             <span class="mf">2.083</span>    <span class="mf">1.042</span>    <span class="mf">4.166</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
<span class="n">sw_4_line_26</span>             <span class="mf">3.399</span>    <span class="mf">1.699</span>    <span class="mf">6.798</span>        <span class="mi">0</span>    <span class="kc">False</span>     <span class="kc">None</span>     <span class="kc">None</span>
</pre></div>
</div>
<p>The last segment of code provides residual plots and updates residuals through the <code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.fit_data.residual_analysis()</span></code> and <a class="reference internal" href="MATS.html#MATS.Dataset.plot_model_residuals" title="MATS.Dataset.plot_model_residuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Dataset.plot_model_residuals()</span></code></a> functions, updates the parameter and baseline linelists <code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.fit_data.update_params()</span></code>, and generates a summary file with the fit results <a class="reference internal" href="MATS.html#MATS.Dataset.plot_model_residuals" title="MATS.Dataset.plot_model_residuals"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Dataset.plot_model_residuals()</span></code></a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_data</span><span class="o">.</span><span class="n">residual_analysis</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">indv_resid_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit_data</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">generate_summary_file</span><span class="p">(</span><span class="n">save_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">plot_model_residuals</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/spectra_residuals.png" src="_images/spectra_residuals.png" />
<p>At the bottom of the Experimental spectra example there is call to the <a class="reference internal" href="MATS.html#MATS.Spectrum.fft_spectrum" title="MATS.Spectrum.fft_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Spectrum.fft_spectrum()</span></code></a> function.  If we hadn’t included the etalon the fit residuals look like this:</p>
<img alt="_images/spectra_residuals_noetalon.png" src="_images/spectra_residuals_noetalon.png" />
<p>Calling the <a class="reference internal" href="MATS.html#MATS.Spectrum.fft_spectrum" title="MATS.Spectrum.fft_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">MATS.Spectrum.fft_spectrum()</span></code></a> function on the residuals when the etalon was not fit out gives the following result with the most abundant period being 1.271443 cm-1 and an amplitude of 0.001364.  The more periods present in the spectral region being fit the more precise the etlaon amplitude and frequency will be.</p>
<img alt="_images/Noetalon_FFT.png" src="_images/Noetalon_FFT.png" />
<p>Using these values as the etalon period and amplitude give the fits shown above and when incorporated the FFT no longer shows a substantial peak.</p>
<img alt="_images/etalon_FFT.png" src="_images/etalon_FFT.png" />
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MATS</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Getting Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="MATS Summary.html">MATS Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generating Parameter Line lists.html">Generating Parameter Line lists</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MATS Example using Experimental and Synthetic Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#import-modules-and-set-up">Import Modules and Set-Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-spectra-from-files">Load Spectra from files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulate-spectra">Simulate Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-a-dataset">Generate a Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-fit-parameter-files">Generate Fit Parameter Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fit-dataset">Fit Dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MATS.html">MATS module</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Generating Parameter Line lists.html" title="previous chapter">Generating Parameter Line lists</a></li>
      <li>Next: <a href="MATS.html" title="next chapter">MATS module</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/MATS Example using Experimental and Synthetic Data.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>